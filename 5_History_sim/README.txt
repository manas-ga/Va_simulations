#############################################################################################
#################### Va Simulations with SLiM history #######################################
#############################################################################################


###  Description of scripts contained in this directory


### 00000_control.sh ###

# Bash script for gridengine on AC3 that allows running "00_History_sim.R " with different command line arguments listed in "000_parameter_grid.txt"


### 00000_control_eddie.sh ###

# Bash script for gridengine on Eddie that allows running "00_History_sim.R " with different command line arguments listed in "000_parameter_grid.txt"


### 000_parameter_grid.txt ###

# List of command line arguments to be fed to "00_History_sim.R" using "00000_control.sh". One set of parameters per line. 
# The parameters appear in the following order: mu, map_length_history, map_length_expt, n_ind_expt, n_cages, ngen_expt, bdelta_method


### 00_History_sim_JARROD.R ###

# This is the main controlling R script that controls the other scripts and runs analyses


### 0_neutral_burnin.py ###

# Uses "msprime" to simulates the ancestry of the population, simulate mutations and attach selection coefficients
# Generates an output in the form of a .trees file that is stored in "b_interim_files/Msprime_outputs"


### 1_History.slim ###

# Reads the output generated by "0_neutral_burnin.py"
# Forward simulates the population (for a large number of generations), to simulate its history. Samples the parents that found the experimental population(s).
# Stores full SLiM outputs of the population at regular intervals in "b_interim_files/SLiM_outputs". 
# Also stores the .trees file for the population at the end of the simulation.


### 1_History_add_neutral_mut.py ###

# Adds neutral mutations to the tree sequences generated at the end of "1_History.slim"

### 2_Extract_mutations.py ###

# A python script that reads a SLiM output file and extracts the information on mutations stooring it as a .txt file in "b_interim_files/Mutations"


### 3_Extract_genomes.py ###

# A python script that reads a SLiM output file and extracts the information on mutations stooring it as a .txt file in "b_interim_files/Mutations"
# Also extracts the c matrix for genomes and stores it as a .csv file in "b_interim_files/C_Matrices"


### 4_Experiment.slim ###

# A SLiM scri[t simulating the expeirment for 4 generations
# Reads the .trees output generated by 1_History.slim
# Generates a full output every generation which is stored in "b_interim_files/SLiM_outputs"


### 5_Analysis_script.R ###

# A standalone script unrelated to the workflow described above.
# This script uses the function "read_analyse_simdata()" to analyse the SLiM outputs for one specific simulation.
