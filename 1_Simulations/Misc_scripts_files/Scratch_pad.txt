##################### Connecting to vera ############################

ssh msamant@vera.bio.ed.ac.uk

# If connection fails, the file "/etc/resolv.conf" has to be edited

sudo nano /etc/resolv.conf

# Add the follwing:

nameserver 129.215.205.191

########### Copying files to and fro

scp -r /mnt/c/Academics/Post-doc/Va_simulations/4_Va_theory msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations

scp /mnt/c/Users/msamant/Downloads/asreml_4.2.0.267_linux-intel64_R4.3.0.tar.gz msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations


/home/msamant/Manas/Va_simulations/asreml_4.2.0.267_linux-intel64_R4.3.0.tar.gz


scp -r msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations /mnt/c/Users/msamant/Downloads

scp -r /mnt/c/Users/msamant/Downloads/5_History_sim msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations

scp /mnt/c/Users/msamant/Downloads/Vw.Rmd msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations/5_History_sim
scp /mnt/c/Users/msamant/Downloads/4_Experiment msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations/5_History_sim

scp /4_Experiment msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations/5_History_sim

scp msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations/5_History_sim/c_Output/Output2023-12-09_14:33:20.511878.RData /mnt/c/Users/msamant/Downloads

#########################################
########## Download Data.csv ############
#########################################

# From Vera

scp msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations/Github/Va_simulations/5_History_sim/c_Output/Data_r_12_07_24.csv /mnt/c/Users/msamant/Downloads
scp msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations/Github/Va_simulations/5_History_sim/b_Interim_files/Mutations/bigfoot_2024-07-15_143524.574016_3.45e-07_1.4_1.4_1000_10_3_sim1_mutations_parents.txt /mnt/c/Users/msamant/Downloads

# From qm

# Downloading mutations for parents
scp -r qm:/data/obbard/Va_simulations/analyses/b_Interim_files/Mutations/<SET_ID>_sim1_mutations_parents.txt  /mnt/c/Users/msamant/Downloads
scp -r qm:/data/obbard/Va_simulations/analyses/b_Interim_files/SLiM_outputs/trial  /mnt/c/Users/msamant/Downloads

# Downloading data
scp -r qm:/data/obbard/Va_simulations/analyses/c_Output/Test_output.csv  /mnt/c/Users/msamant/Downloads 



scp -r qm:/data/obbard/Va_simulations/analyses/c_Output/Data_30_July.csv  /mnt/c/Users/msamant/Downloads 

scp /mnt/c/Users/msamant/Downloads/asreml_4.2.0.302_linux-intel64_R4.3.0.tar.gz qmaster:/ceph/users/marun/Downloads

scp /mnt/c/Users/msamant/Downloads/00_History_sim_JARROD.R msamant@vera.bio.ed.ac.uk:/home/msamant/Manas/Va_simulations/5_History_sim


# Downloading and syncing data

scp qm:/ceph/users/marun/Downloads/Va_env.yml /mnt/u/Datastore/CSCE/biology/groups/hadfield/Va_simulations
rsync -r --ignore-existing qm:/data/obbard/Va_simulations/analyses/c_Output/  /mnt/u/Datastore/CSCE/biology/groups/hadfield/Va_simulations/sim_files/sim_params
rsync -r --ignore-existing qm:/data/obbard/Va_simulations/analyses/b_Interim_files/SLiM_outputs/  /mnt/u/Datastore/CSCE/biology/groups/hadfield/Va_simulations/sim_files/SLiM_outputs
rsync -r --ignore-existing qm:/data/obbard/Va_simulations/analyses/c_Output/  /mnt/c/Users/msamant/Documents/GitHub/Va_simulations/4_analysed_data

#############################
## mounting drives on WSL ###
#############################

sudo mount -t drvfs U: /mnt/u


#######################################
## Removing semicolin from filename ###
#######################################

for file in *; do mv "$file" `echo $file | tr ':' '_'` ; done

##############################
## Istalling conda on Eddie ##
##############################

mkdir -p /exports/csce/eddie/biology/groups/hadfield/miniconda3
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O /exports/csce/eddie/biology/groups/hadfield/miniconda3/miniconda.sh
bash /exports/csce/eddie/biology/groups/hadfield/miniconda3/miniconda.sh -b -u -p /exports/csce/eddie/biology/groups/hadfield/miniconda3
rm -rf /exports/csce/eddie/biology/groups/hadfield/miniconda3/miniconda.sh


###############################
## Istalling conda on Basden ##
###############################

mkdir -p ~/miniconda3
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda3/miniconda.sh
bash ~/miniconda3/miniconda.sh -b -u -p ~/miniconda3
rm -rf ~/miniconda3/miniconda.sh

#############################
##### Installing asreml #####
#############################

install.packages("asreml_4.2.0.302_linux-intel64_R4.3.0.tar.gz", repos = NULL)
# License = AGIJ-FFFF-HFCJ-BEJA
# Site ref = VS5AA2

C:\Users\msamant\Dropbox\PhD\Actual Work\Manuscripts\Manuscript 4 (Sex-specific traits)\Proc_B\Data and Code



system(paste("slim", expt_arg1, expt_arg2, expt_arg3, expt_arg4, expt_arg5, expt_arg6, expt_arg7, expt_arg8, "/mnt/c/Academics/Post-doc/Va_simulations/5_History_sim/4_Experiment1.slim"))


##########################################
######### Loading temp data ##############
##########################################

load("/mnt/c/Academics/Post-doc/Va_simulations/5_History_sim/c_Output/Output_temp.Rdata")


##########################################
######## Code parallelization ############
##########################################

parallel -j 18 --colsep "\s" --delay 5.0 Rscript 00_History_sim_JARROD.R :::: 000_parameter_grid.txt
https://www.danielecook.com/using-gnu-parallel-for-bioinformatics/


#########################################
####### Packages installed in Va ########
#########################################
# packages in environment at /home/manas_ga/miniconda3/envs/Va:
#
# Name                    Version                   Build  Channel
_libgcc_mutex             0.1                 conda_forge    conda-forge
_openmp_mutex             4.5                       2_gnu    conda-forge
_r-mutex                  1.0.1               anacondar_1    conda-forge
attrs                     23.1.0             pyh71513ae_1    conda-forge
binutils_impl_linux-64    2.40                 hf600244_0    conda-forge
bwidget                   1.9.14               ha770c72_1    conda-forge
bzip2                     1.0.8                h7f98852_4    conda-forge
c-ares                    1.19.1               hd590300_0    conda-forge
ca-certificates           2023.11.17           hbcca054_0    conda-forge
cairo                     1.16.0            h0c91306_1017    conda-forge
curl                      8.3.0                hca28451_0    conda-forge
demes                     0.2.3              pyhd8ed1ab_0    conda-forge
expat                     2.5.0                hcb278e6_1    conda-forge
font-ttf-dejavu-sans-mono 2.37                 hab24e00_0    conda-forge
font-ttf-inconsolata      3.000                h77eed37_0    conda-forge
font-ttf-source-code-pro  2.038                h77eed37_0    conda-forge
font-ttf-ubuntu           0.83                 hab24e00_0    conda-forge
fontconfig                2.14.2               h14ed4e7_0    conda-forge
fonts-conda-ecosystem     1                             0    conda-forge
fonts-conda-forge         1                             0    conda-forge
freetype                  2.12.1               h267a509_2    conda-forge
fribidi                   1.0.10               h36c2ea0_0    conda-forge
gcc_impl_linux-64         13.2.0               h338b0a0_1    conda-forge
gettext                   0.21.1               h27087fc_0    conda-forge
gfortran_impl_linux-64    13.2.0               h76e1118_1    conda-forge
gmp                       6.3.0                h59595ed_0    conda-forge
graphite2                 1.3.13            h58526e2_1001    conda-forge
gsl                       2.7                  he838d99_0    conda-forge
gxx_impl_linux-64         13.2.0               h338b0a0_1    conda-forge
harfbuzz                  8.2.1                h3d44ed6_0    conda-forge
humanize                  4.8.0              pyhd8ed1ab_0    conda-forge
icu                       73.2                 h59595ed_0    conda-forge
importlib-metadata        6.8.0              pyha770c72_0    conda-forge
importlib_metadata        6.8.0                hd8ed1ab_0    conda-forge
importlib_resources       6.0.1              pyhd8ed1ab_0    conda-forge
jsonschema                4.19.0             pyhd8ed1ab_1    conda-forge
jsonschema-specifications 2023.7.1           pyhd8ed1ab_0    conda-forge
kastore                   0.3.2           py311h4c7f6c3_1    conda-forge
kernel-headers_linux-64   2.6.32              he073ed8_16    conda-forge
keyutils                  1.6.1                h166bdaf_0    conda-forge
krb5                      1.21.2               h659d440_0    conda-forge
ld_impl_linux-64          2.40                 h41732ed_0    conda-forge
lerc                      4.0.0                h27087fc_0    conda-forge
libblas                   3.9.0           18_linux64_openblas    conda-forge
libcblas                  3.9.0           18_linux64_openblas    conda-forge
libcurl                   8.3.0                hca28451_0    conda-forge
libdeflate                1.19                 hd590300_0    conda-forge
libedit                   3.1.20191231         he28a2e2_2    conda-forge
libev                     4.33                 h516909a_1    conda-forge
libexpat                  2.5.0                hcb278e6_1    conda-forge
libffi                    3.4.2                h7f98852_5    conda-forge
libgcc-devel_linux-64     13.2.0               ha9c7c90_1    conda-forge
libgcc-ng                 13.2.0               h807b86a_1    conda-forge
libgfortran-ng            13.2.0               h69a702a_1    conda-forge
libgfortran5              13.2.0               ha4646dd_1    conda-forge
libglib                   2.78.0               hebfc3b9_0    conda-forge
libgomp                   13.2.0               h807b86a_1    conda-forge
libiconv                  1.17                 h166bdaf_0    conda-forge
libjpeg-turbo             2.1.5.1              hd590300_1    conda-forge
liblapack                 3.9.0           18_linux64_openblas    conda-forge
libnghttp2                1.52.0               h61bc06f_0    conda-forge
libnsl                    2.0.0                h7f98852_0    conda-forge
libopenblas               0.3.24          pthreads_h413a1c8_0    conda-forge
libpng                    1.6.39               h753d276_0    conda-forge
libsanitizer              13.2.0               h7e041cc_1    conda-forge
libsqlite                 3.43.0               h2797004_0    conda-forge
libssh2                   1.11.0               h0841786_0    conda-forge
libstdcxx-devel_linux-64  13.2.0               ha9c7c90_1    conda-forge
libstdcxx-ng              13.2.0               h7e041cc_1    conda-forge
libtiff                   4.6.0                h29866fb_1    conda-forge
libuuid                   2.38.1               h0b41bf4_0    conda-forge
libwebp-base              1.3.2                hd590300_0    conda-forge
libxcb                    1.15                 h0b41bf4_0    conda-forge
libxml2                   2.11.5               h232c23b_1    conda-forge
libzlib                   1.2.13               hd590300_5    conda-forge
make                      4.3                  hd18ef5c_1    conda-forge
msprime                   1.2.0           py311ha172985_2    conda-forge
ncurses                   6.4                  hcb278e6_0    conda-forge
numpy                     1.26.0          py311h64a7726_0    conda-forge
openssl                   3.1.4                hd590300_0    conda-forge
pandoc                    3.1.3                h32600fe_0    conda-forge
pango                     1.50.14              ha41ecd1_2    conda-forge
pcre2                     10.40                hc3806b6_0    conda-forge
pip                       23.2.1             pyhd8ed1ab_0    conda-forge
pixman                    0.40.0               h36c2ea0_0    conda-forge
pkgutil-resolve-name      1.3.10             pyhd8ed1ab_1    conda-forge
pthread-stubs             0.4               h36c2ea0_1001    conda-forge
pyparsing                 3.1.1              pyhd8ed1ab_0    conda-forge
pyslim                    1.0.4              pyhd8ed1ab_0    conda-forge
python                    3.11.5          hab00c5b_0_cpython    conda-forge
python_abi                3.11                    3_cp311    conda-forge
r-base                    4.3.1                h5cdd412_4    conda-forge
readline                  8.2                  h8228510_1    conda-forge
referencing               0.30.2             pyhd8ed1ab_0    conda-forge
rpds-py                   0.10.3          py311h46250e7_0    conda-forge
ruamel.yaml               0.17.32         py311h459d7ec_0    conda-forge
ruamel.yaml.clib          0.2.7           py311h2582759_1    conda-forge
sed                       4.8                  he412f7d_0    conda-forge
setuptools                68.2.2             pyhd8ed1ab_0    conda-forge
six                       1.16.0             pyh6c4a22f_0    conda-forge
slim                      4.0.1                h27087fc_1    conda-forge
svgwrite                  1.4.3              pyhd8ed1ab_0    conda-forge
sysroot_linux-64          2.12                he073ed8_16    conda-forge
tk                        8.6.12               h27826a3_0    conda-forge
tktable                   2.10                 h0c5db8f_3    conda-forge
tskit                     0.5.5           py311h1f0f07a_0    conda-forge
tzdata                    2023c                h71feb2d_0    conda-forge
wheel                     0.41.2             pyhd8ed1ab_0    conda-forge
xorg-kbproto              1.0.7             h7f98852_1002    conda-forge
xorg-libice               1.1.1                hd590300_0    conda-forge
xorg-libsm                1.2.4                h7391055_0    conda-forge
xorg-libx11               1.8.6                h8ee46fc_0    conda-forge
xorg-libxau               1.0.11               hd590300_0    conda-forge
xorg-libxdmcp             1.1.3                h7f98852_0    conda-forge
xorg-libxext              1.3.4                h0b41bf4_2    conda-forge
xorg-libxrender           0.9.11               hd590300_0    conda-forge
xorg-libxt                1.3.0                hd590300_1    conda-forge
xorg-renderproto          0.11.1            h7f98852_1002    conda-forge
xorg-xextproto            7.3.0             h0b41bf4_1003    conda-forge
xorg-xproto               7.0.31            h7f98852_1007    conda-forge
xz                        5.2.6                h166bdaf_0    conda-forge
zipp                      3.16.2             pyhd8ed1ab_0    conda-forge
zlib                      1.2.13               hd590300_5    conda-forge
zstd                      1.5.5                hfc55251_0    conda-forge
(Va) manas_ga@SCE-BIO-C06645:~$

####### Stuff that needs to be installed #########

## conda

## R base and packages 

rmutil
MCMCglmm
ggplot2
jsonlite
data.table
rmarkdown
pryr
bigalgebra
Rspectra
RhpcBLASctl

## pandoc

## msprime

## pyslim

## slim

## Python

## Numpy


###### Cloning a remote github repository ###### (as of 19 July 2024; the token might change)

Token: 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

# Code to clone repo:

git clone https://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@github.com/manas-ga/Va_simulations.git
git clone https://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@github.com/manas-ga/Sex-specific-Price-Robertson-Covariances.git

################################################
############# AC3 related stuff ################
################################################

wstat # for checking activity on various nodes
qlogin -N Test -V -l h=bigbird # logging on to a specific node ("bigshot", in this example)


pandoc error

pandoc: Vw.knit.md: withBinaryFile: does not exist (No such file or directory)
Error: pandoc document conversion failed with error 1
Execution halted

###########################################################################
### Getting Set and sim IDs and storing them as analysis_param_grid.txt ###
###########################################################################

cd /data/obbard/Va_simulations/analyses/b_Interim_files/std_out

# Creating and downloading analysis_param_grid.txt 
cat *Set_3* | grep -v Set_ID | cut -d "," -f 1,2 | tr -d \" | tr ',' ' ' > analysis_param_grid.txt ## On AC3
scp qm:/data/obbard/Va_simulations/analyses/c_Output/analysis_param_grid.txt /mnt/c/Users/msamant/Documents/GitHub/Va_simulations/2_Analysis ## On  local WSL

cat Set_1*Data_analysis*csv | head -1 | tr -d \" > /mnt/c/Users/msamant/Downloads/Set_1_output.csv
cat Set_1*Data_analysis*csv | grep -v Set_ID | tr -d \" >> /mnt/c/Users/msamant/Downloads/Set_1_output.csv

# Downloading data
scp -r qm:/data/obbard/Va_simulations/analyses/c_Output/Test_output.csv  /mnt/c/Users/msamant/Downloads 
rsync -r --ignore-existing qm:/data/obbard/Va_simulations/analyses/c_Output/  /mnt/c/Users/msamant/Documents/GitHub/Va_simulations/4_analysed_data

install.packages("/mnt/c/Users/msamant/Documents/GitHub/Va_simulations/Vw", repos = NULL, type = "source")

### Install Vw on AC3

install.packages("~/Va_simulations/Vw", repos = NULL, type = "source")


#############
### SLURM ###
#############

https://rcpedia.stanford.edu/topicGuides/jobArrayRExample.html